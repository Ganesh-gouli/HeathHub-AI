import{r as d,j as e,I as V,o as C,c as D}from"./index-CXTOnbpn.js";import{L as $}from"./LoadingSpinner-BDg57fWP.js";const z=({service:s,categoryIcon:i,distance:k})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow flex flex-col h-full border border-gray-100 dark:border-gray-700 group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-lg shrink-0 group-hover:bg-green-100 dark:group-hover:bg-green-900/50 transition-colors",children:i}),e.jsx("div",{children:e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 leading-tight",children:s.name})})]}),s.rating&&s.rating>0&&e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-xs font-bold text-yellow-700 dark:text-yellow-400 bg-yellow-100 dark:bg-yellow-900/30 px-2 py-1 rounded-full flex-shrink-0",children:[e.jsx("span",{children:s.rating.toFixed(1)}),e.jsx("svg",{className:"w-3 h-3 text-yellow-500 fill-current",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})})]}),e.jsx("div",{className:"flex mt-1",children:[1,2,3,4,5].map(c=>e.jsx("svg",{className:`w-2 h-2 ${c<=Math.round(s.rating||0)?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600"}`,viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})},c))})]})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2 flex-grow pl-[3.25rem] leading-snug",children:s.address}),e.jsxs("div",{className:"mt-4 flex items-center justify-end space-x-2 pl-[3.25rem]",children:[e.jsx("button",{onClick:()=>{const c=`${s.name}
${s.address}`;navigator.clipboard.writeText(c),alert("Address copied to clipboard!")},className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Copy Address",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})}),e.jsxs("a",{href:s.mapsUri,target:"_blank",rel:"noopener noreferrer",className:"flex-grow text-center py-2 px-4 bg-gray-50 dark:bg-gray-700 hover:bg-green-50 dark:hover:bg-green-900/20 text-sm font-medium text-gray-700 dark:text-gray-200 hover:text-green-600 dark:hover:text-green-400 rounded-lg transition-colors flex items-center justify-center border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{children:"Get Directions"}),e.jsx("svg",{className:"w-4 h-4 ml-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]})]}),G=(s,i,k,c)=>{if(!s||!i||!k||!c)return 0;const h=6371,y=N(k-s),u=N(c-i),j=Math.sin(y/2)*Math.sin(y/2)+Math.cos(N(s))*Math.cos(N(k))*Math.sin(u/2)*Math.sin(u/2),x=2*Math.atan2(Math.sqrt(j),Math.sqrt(1-j));return h*x},N=s=>s*(Math.PI/180),U=()=>{const[s,i]=d.useState("idle"),[k,c]=d.useState(null),[h,y]=d.useState(null),[u,j]=d.useState(""),[x,W]=d.useState("All"),[H,L]=d.useState(!1),[t,M]=d.useState(null),[v,A]=d.useState(20),[f,B]=d.useState(0),p=d.useRef(!0),b=d.useRef(!1);d.useEffect(()=>(p.current=!0,()=>{p.current=!1}),[]);const P=async()=>{if(b.current)return;if(b.current=!0,p.current&&(i("locating"),c(null),y(null)),!navigator.geolocation){p.current&&(c("Geolocation is not supported by your browser. Please try manual search."),i("error"),b.current=!1);return}const a=r=>new Promise((n,o)=>{navigator.geolocation.getCurrentPosition(n,o,r)});try{let r;try{r=await a({enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}catch(F){console.warn("High accuracy GPS failed, retrying with low accuracy...",F),r=await a({enableHighAccuracy:!1,timeout:2e4,maximumAge:0})}if(!p.current)return;const{latitude:n,longitude:o,accuracy:l}=r.coords;M({lat:n,lng:o,accuracy:l}),i("fetching");const g=await C({lat:n,lng:o});p.current&&(y(g),i("success"))}catch(r){if(!p.current)return;let n="An unknown error occurred while getting your location.";r.code===r.PERMISSION_DENIED?n="Location access denied. Please click the lock icon in your address bar to allow location access, then try again.":r.code===r.POSITION_UNAVAILABLE?n="Location unavailable. Please use manual search.":r.code===r.TIMEOUT&&(n="Location request timed out. Please try again or use manual search."),c(n),i("error")}finally{b.current=!1}},E=async a=>{if(a.preventDefault(),!u.trim())return;i("fetching"),c(null),y(null),L(!0);const r=u.match(/^(-?\d+(\.\d+)?),\s*(-?\d+(\.\d+)?)$/);try{let n;if(r){const o=parseFloat(r[1]),l=parseFloat(r[3]);M({lat:o,lng:l,accuracy:0}),n=await C({lat:o,lng:l})}else M(null),n=await C(u);y(n),i("success")}catch(n){c(`Failed to find services for "${u}". ${D(n)}`),i("error")}},I=["All","Hospitals","Clinics","Medical Stores"],S=d.useMemo(()=>{if(!h)return{hospitals:[],clinics:[],medicalStores:[]};const a=t&&(t.lat!==0||t.lng!==0),r=n=>{let o=n.map(l=>{const g=a?G(t.lat,t.lng,l.latitude,l.longitude):void 0;return{...l,distance:g}});return a&&(o=o.filter(l=>l.distance<=v),o.sort((l,g)=>l.distance-g.distance)),f>0&&(o=o.filter(l=>(l.rating||0)>=f)),o};return{hospitals:r(h.hospitals),clinics:r(h.clinics),medicalStores:r(h.medicalStores)}},[h,t,v,f]),R=()=>{if(s==="idle")return e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 bg-white dark:bg-gray-800 rounded-3xl border border-gray-100 dark:border-gray-700 text-center animate-fade-in shadow-sm",children:[e.jsx("div",{className:"w-20 h-20 bg-green-50 dark:bg-green-900/30 rounded-full flex items-center justify-center text-green-600 dark:text-green-400 mb-6 shadow-inner",children:e.jsxs("svg",{className:"w-10 h-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"Find Health Services Near You"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-8 max-w-md mx-auto",children:"Locate hospitals, clinics, and pharmacies in your area instantly."}),e.jsxs("button",{onClick:P,className:"px-8 py-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-lg font-bold rounded-2xl hover:shadow-lg hover:scale-105 transition-all duration-300 flex items-center",children:[e.jsxs("svg",{className:"w-6 h-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Use My Current Location"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-4",children:"Or search manually by city name above"})]});if(s==="locating")return e.jsx($,{message:"Acquiring precise GPS location..."});if(s==="fetching")return e.jsx($,{message:`Scanning for health services ${H?"in designated area":"nearby"}...`});if(s==="error")return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 bg-white dark:bg-gray-800 rounded-2xl border border-gray-100 dark:border-gray-700 text-center animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center text-red-500 mb-4",children:V.warning}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:"Location Error"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md",children:k}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>{b.current=!1,P()},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-md",children:"Retry GPS"}),e.jsx("button",{onClick:()=>L(!0),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Search Manually"})]})]});if(s==="success"&&h){const a=x==="All"||x==="Hospitals",r=x==="All"||x==="Clinics",n=x==="All"||x==="Medical Stores",o=S.hospitals,l=S.clinics,g=S.medicalStores;return a&&o.length||r&&l.length||n&&g.length?e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t?e.jsxs(e.Fragment,{children:["Showing results within ",e.jsxs("strong",{children:[v,"km"]})," ",f>0?"rated 4.0+":"","."]}):e.jsx(e.Fragment,{children:"Showing top results for your search area."})})}),a&&o.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center",children:[e.jsx("span",{className:"bg-red-100 text-red-600 p-1.5 rounded-lg mr-2 shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m8-2a2 2 0 100-4 2 2 0 000 4zm-8-4a2 2 0 100-4 2 2 0 000 4zm-2-4a2 2 0 100-4 2 2 0 000 4zm16-4a2 2 0 100-4 2 2 0 000 4zm-8-4a2 2 0 100-4 2 2 0 000 4zm-2-4a2 2 0 100-4 2 2 0 000 4z"})})}),"Hospitals"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:o.map((m,w)=>e.jsx(z,{service:m,distance:m.distance,categoryIcon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m8-2a2 2 0 100-4 2 2 0 000 4zm-8-4a2 2 0 100-4 2 2 0 000 4zm-2-4a2 2 0 100-4 2 2 0 000 4zm16-4a2 2 0 100-4 2 2 0 000 4zm-8-4a2 2 0 100-4 2 2 0 000 4zm-2-4a2 2 0 100-4 2 2 0 000 4z"})})},w))})]}),r&&l.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center",children:[e.jsx("span",{className:"bg-blue-100 text-blue-600 p-1.5 rounded-lg mr-2 shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m8-2a2 2 0 100-4 2 2 0 000 4z"})})}),"Clinics"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:l.map((m,w)=>e.jsx(z,{service:m,distance:m.distance,categoryIcon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},w))})]}),n&&g.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center",children:[e.jsx("span",{className:"bg-green-100 text-green-600 p-1.5 rounded-lg mr-2 shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),"Medical Stores"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:g.map((m,w)=>e.jsx(z,{service:m,distance:m.distance,categoryIcon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})},w))})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400 animate-fade-in",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-full mb-4",children:e.jsx("svg",{className:"w-8 h-8 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("p",{children:"No matches found."}),e.jsx("p",{className:"text-xs mt-1",children:"Try adjusting your filters or expanding your search."}),e.jsx("button",{onClick:()=>{A(20),B(0)},className:"mt-4 text-green-600 font-medium hover:underline text-sm",children:"Reset Filters"})]})}return null};return e.jsxs("div",{className:"max-w-6xl mx-auto px-2 sm:px-0 animate-fade-in-up",children:[e.jsxs("div",{className:"mb-8 text-center md:text-left",children:[e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 dark:text-white tracking-tight",children:"Nearby Health Services"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Find the closest hospitals, clinics, and pharmacies."})]}),t&&e.jsxs("div",{className:`mb-6 p-3 rounded-xl border flex items-center justify-between text-sm ${t.accuracy&&t.accuracy>1e3?"bg-yellow-50 border-yellow-200 text-yellow-800":"bg-green-50 border-green-200 text-green-800"} dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300`,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("svg",{className:"w-5 h-5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Current Location:"})," ",t.lat.toFixed(6),", ",t.lng.toFixed(6),t.accuracy&&t.accuracy>0&&e.jsxs("span",{className:"ml-2 text-xs opacity-75",children:["(Accuracy: Â±",t.accuracy.toFixed(0),"m)"]}),t.accuracy&&t.accuracy>1e3&&e.jsx("p",{className:"text-xs text-yellow-600 mt-1 font-semibold",children:"Low accuracy detected. Try manual search or coordinates if results are incorrect."})]})]}),e.jsx("a",{href:`https://www.google.com/maps/search/?api=1&query=${t.lat},${t.lng}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 dark:text-green-400 underline hover:text-green-700 ml-4 shrink-0",children:"Verify on Map"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 p-4 mb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("form",{onSubmit:E,className:"w-full md:w-1/2 relative",children:[e.jsx("input",{type:"text",value:u,onChange:a=>j(a.target.value),placeholder:"Enter 'Lat, Lng' OR city name...",className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500/50 transition-all text-gray-900 dark:text-white"}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),H&&e.jsx("button",{type:"button",onClick:()=>{j(""),L(!1)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-green-600 font-semibold hover:underline bg-white dark:bg-gray-800 px-2 py-1 rounded shadow-sm",children:"Use GPS"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full md:w-auto",children:[e.jsxs("select",{value:v,onChange:a=>A(Number(a.target.value)),disabled:!t,className:`px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-green-500 cursor-pointer ${t?"":"opacity-50 cursor-not-allowed"}`,title:t?"Filter by distance":"Distance filtering disabled for text searches",children:[e.jsx("option",{value:"1",children:"Within 1 km"}),e.jsx("option",{value:"2",children:"Within 2 km"}),e.jsx("option",{value:"5",children:"Within 5 km"}),e.jsx("option",{value:"10",children:"Within 10 km"}),e.jsx("option",{value:"20",children:"Within 20 km"})]}),e.jsxs("button",{onClick:()=>B(a=>a===0?4:0),className:`flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-colors border ${f>0?"bg-yellow-50 dark:bg-yellow-900/30 border-yellow-200 dark:border-yellow-700 text-yellow-700 dark:text-yellow-400":"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300"}`,children:[e.jsx("svg",{className:`w-4 h-4 mr-1 ${f>0?"fill-current":"text-gray-400"}`,viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:f>0?0:2,children:e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),"4.0+ Stars"]})]})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 p-1 rounded-xl w-full overflow-x-auto mt-4",children:I.map(a=>e.jsx("button",{onClick:()=>W(a),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap flex-grow md:flex-grow-0 ${x===a?"bg-white dark:bg-gray-600 text-green-600 dark:text-green-400 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:a},a))})]}),R()]})};export{U as default};
