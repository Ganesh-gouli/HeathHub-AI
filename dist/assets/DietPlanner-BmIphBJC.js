import{u as G,r as n,D as R,j as e,I as g,H as Y,L as _,e as K,c as X}from"./index-CXTOnbpn.js";import{L as q}from"./LoadingSpinner-BDg57fWP.js";import{D as J}from"./Skeletons-Bt8z-9NO.js";const $=({textToSpeak:f,title:a,selectedLanguage:m})=>{const[u,b]=n.useState(!1),l=n.useRef(null),[y,x]=n.useState([]);n.useEffect(()=>{const d=()=>{x(window.speechSynthesis.getVoices())};window.speechSynthesis.addEventListener("voiceschanged",d),d();const i=new SpeechSynthesisUtterance;return l.current=i,i.onstart=()=>b(!0),i.onend=()=>b(!1),i.onerror=o=>{o.error!=="interrupted"&&console.error("Speech synthesis error:",o.error),b(!1)},()=>{window.speechSynthesis.removeEventListener("voiceschanged",d),window.speechSynthesis.cancel()}},[]);const N=()=>{if(l.current)if(u)window.speechSynthesis.cancel();else{window.speechSynthesis.cancel();const d=`${a}. ${f}`;l.current.text=d;const o={English:"en-US",Hindi:"hi-IN",Kannada:"kn-IN",Tamil:"ta-IN",Telugu:"te-IN",Bengali:"bn-IN",Marathi:"mr-IN",Gujarati:"gu-IN"}[m]||"en-US";l.current.lang=o;const k=y.find(h=>h.lang===o)||y.find(h=>h.lang.startsWith(o.split("-")[0]));k?l.current.voice=k:l.current.voice=null,window.speechSynthesis.speak(l.current)}};return e.jsx("button",{onClick:N,className:"p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none transition-colors","aria-label":u?`Stop reading ${a}`:`Read ${a} aloud`,children:u?g.speakerOff:g.speaker})},re=()=>{var M,D,T,A;const{user:f,dietPlan:a,setDietPlan:m,navigateTo:u,addFoodItems:b,dailyLog:l,removeFoodItem:y}=G(),[x,N]=n.useState([]),[d,i]=n.useState(""),[o,k]=n.useState(""),[h,F]=n.useState(""),[I,H]=n.useState(""),[P,B]=n.useState(R[0]),[U,L]=n.useState(!1),[E,w]=n.useState(""),[j,W]=n.useState("English"),O=r=>{N(s=>s.includes(r)?s.filter(t=>t!==r):[...s,r])},V=async r=>{if(r.preventDefault(),!f){w("User profile not found.");return}L(!0),w(""),m(null);const s={healthIssues:x,pregnancyMonth:x.includes("Pregnancy")?d:void 0,otherHealthIssues:o,preexistingMedicalConditions:h,foodAllergies:I,dietaryPreference:P};try{const t=await K(f,s,j);m(t)}catch(t){w(`Failed to generate diet plan. ${X(t)}`),console.error(t)}finally{L(!1)}},z=r=>{const s=l.loggedFoods.find(t=>t.name===r.name&&t.calories===r.calories&&t.source==="plan");s?y(s):b([{name:r.name,calories:r.calories}],"plan")},v=({title:r,options:s})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-md transition-shadow duration-200",children:[e.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white mb-4 border-b border-gray-100 dark:border-gray-700 pb-2",children:r}),e.jsx("ul",{className:"space-y-3",children:(s||[]).map((t,S)=>{const c=l.loggedFoods.some(C=>C.name===t.name&&C.calories===t.calories&&C.source==="plan");return e.jsxs("li",{className:`group relative flex flex-col sm:flex-row justify-between items-start sm:items-center p-3 rounded-xl transition-all duration-200 border ${c?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-700/30 border-transparent hover:border-gray-200 dark:hover:border-gray-600"}`,children:[e.jsxs("div",{className:"flex-grow pr-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`font-semibold ${c?"text-green-800 dark:text-green-300":"text-gray-800 dark:text-gray-200"}`,children:t.name}),c&&e.jsx("span",{className:"ml-2 text-green-600 dark:text-green-400 text-xs",children:g.checkCircle})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 leading-snug",children:t.description}),e.jsxs("span",{className:"inline-block mt-1 text-xs font-medium text-gray-400 dark:text-gray-500",children:[t.calories," kcal"]})]}),e.jsx("button",{onClick:()=>z(t),className:`mt-2 sm:mt-0 flex-shrink-0 text-xs font-semibold px-4 py-2 rounded-lg transition-all duration-200 shadow-sm ${c?"bg-red-50 text-red-600 hover:bg-red-100 dark:bg-red-900/20 dark:text-red-300 dark:hover:bg-red-900/40":"bg-green-600 text-white hover:bg-green-700 dark:bg-green-600 dark:hover:bg-green-500"}`,children:c?"Remove":"Add"})]},S)})})]}),p=({title:r,items:s})=>{const t=s&&s.length>0?s.join(". "):"No information provided.";return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"font-bold text-green-700 dark:text-green-400",children:r}),e.jsx($,{title:r,textToSpeak:t,selectedLanguage:j})]}),s&&s.length>0?e.jsx("ul",{className:"space-y-2 text-gray-600 dark:text-gray-300 text-sm",children:s.map((S,c)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-green-500 mt-1",children:"â€¢"}),e.jsx("span",{children:S})]},c))}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:"No specific information."})]})};return U?e.jsxs("div",{className:"max-w-5xl mx-auto p-4 md:p-8",children:[e.jsx(q,{message:"Designing your personalized nutrition plan..."}),e.jsx("div",{className:"opacity-25 pointer-events-none filter blur-sm transition-all duration-700",children:e.jsx(J,{})})]}):a?e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fade-in px-2 sm:px-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end border-b border-gray-200 dark:border-gray-700 pb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Your Diet Plan"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Tailored to your health profile and preferences."})]}),e.jsxs("button",{onClick:()=>m(null),className:"mt-4 md:mt-0 text-sm font-medium text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 hover:underline flex items-center",children:[g.edit," ",e.jsx("span",{className:"ml-1",children:"Modify Constraints"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(v,{title:"Breakfast",options:((M=a.mealPlan)==null?void 0:M.breakfast)||[]}),e.jsx(v,{title:"Lunch",options:((D=a.mealPlan)==null?void 0:D.lunch)||[]}),e.jsx(v,{title:"Snacks",options:((T=a.mealPlan)==null?void 0:T.snacks)||[]}),e.jsx(v,{title:"Dinner",options:((A=a.mealPlan)==null?void 0:A.dinner)||[]})]}),a.reasoning&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white dark:from-blue-900/20 dark:to-gray-800 border border-blue-100 dark:border-blue-800/50 p-6 rounded-2xl shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"text-xl font-bold text-blue-800 dark:text-blue-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:g.lightbulb})," Insight"]}),e.jsx($,{title:"Diet Plan Insight",textToSpeak:a.reasoning,selectedLanguage:j})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-sm md:text-base",children:a.reasoning})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(p,{title:"Foods to Include",items:a.foodsToInclude}),e.jsx(p,{title:"Foods to Avoid",items:a.foodsToAvoid}),e.jsx(p,{title:"Health Recommendations",items:a.healthRecommendations}),e.jsx(p,{title:"Precautions & Tips",items:a.precautions}),e.jsx(p,{title:"Lifestyle Modifications",items:a.lifestyleModifications})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-6 rounded-2xl border border-purple-100 dark:border-purple-800/50 flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-purple-900 dark:text-purple-300 mb-1",children:"Complement Your Diet"}),e.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-400",children:"We've also prepared some exercise recommendations for you."})]}),e.jsx("button",{onClick:()=>u("EXERCISE_CORNER"),className:"px-6 py-3 bg-purple-600 text-white font-bold rounded-xl shadow-lg shadow-purple-500/30 hover:bg-purple-700 transition-transform transform hover:-translate-y-0.5",children:"View Workout Plan"})]})]}):e.jsxs("div",{className:"max-w-4xl mx-auto bg-white dark:bg-gray-800 p-6 md:p-10 rounded-3xl shadow-xl border border-gray-100 dark:border-gray-700 animate-fade-in-up",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 mb-4",children:g.diet}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 dark:text-white tracking-tight",children:"Create Your Diet Plan"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2 text-lg",children:"Tell us about your needs, and our AI will craft the perfect meal plan."})]}),e.jsxs("form",{onSubmit:V,className:"space-y-8",children:[E&&e.jsxs("div",{className:"flex items-start p-4 bg-red-50 dark:bg-red-900/30 rounded-xl border border-red-100 dark:border-red-800",children:[e.jsx("div",{className:"flex-shrink-0 text-red-500 dark:text-red-400",children:g.warning}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:E})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-4 uppercase tracking-wider",children:"Health Issues"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:Y.map(r=>{const s=x.includes(r);return e.jsxs("div",{onClick:()=>O(r),className:`cursor-pointer p-4 rounded-xl border-2 transition-all duration-200 flex items-center space-x-3 ${s?"bg-green-50 border-green-500 dark:bg-green-900/20 dark:border-green-500 shadow-md":"bg-gray-50 border-transparent hover:border-gray-200 dark:bg-gray-700/50 dark:hover:border-gray-600"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center border ${s?"bg-green-500 border-green-500":"border-gray-300 dark:border-gray-500 bg-white dark:bg-gray-800"}`,children:s&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:`font-medium ${s?"text-green-800 dark:text-green-300":"text-gray-700 dark:text-gray-300"}`,children:r})]},r)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Other Health Issues"}),e.jsx("textarea",{value:o,onChange:r=>k(r.target.value),rows:2,className:"block w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all resize-none text-gray-900 dark:text-white",placeholder:"Any specific conditions not listed above..."})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/30 p-6 rounded-2xl space-y-6",children:[x.includes("Pregnancy")&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Pregnancy Progress"}),e.jsx("input",{type:"number",placeholder:"Months",value:d,onChange:r=>i(r.target.value),className:"block w-full px-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Language Preference"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:j,onChange:r=>W(r.target.value),className:"block w-full px-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all appearance-none cursor-pointer",children:_.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-500",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Dietary Preference"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:P,onChange:r=>B(r.target.value),className:"block w-full px-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all appearance-none cursor-pointer",children:R.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-500",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Food Allergies"}),e.jsx("input",{type:"text",placeholder:"e.g., Peanuts, Shellfish, Lactose",value:I,onChange:r=>H(r.target.value),className:"block w-full px-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Pre-existing Conditions"}),e.jsx("textarea",{value:h,onChange:r=>F(r.target.value),rows:2,className:"block w-full px-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all resize-none",placeholder:"Medical history..."})]})]}),e.jsx("button",{type:"submit",className:"w-full py-4 px-6 bg-gradient-to-r from-green-600 to-teal-600 text-white font-bold text-lg rounded-2xl shadow-lg shadow-green-500/30 hover:shadow-xl hover:-translate-y-1 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Generate Personalized Plan"})]})]})};export{re as default};
