import{r as c,j as e,I as B,u as q,E as D,l as V,m as Y,c as U,n as X}from"./index-CXTOnbpn.js";import{L as Q}from"./LoadingSpinner-BDg57fWP.js";import{E as J}from"./Skeletons-Bt8z-9NO.js";const h={LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28},Z=[[11,12],[11,13],[13,15],[12,14],[14,16],[11,23],[12,24],[23,24],[23,25],[25,27],[24,26],[26,28]];function L(r,t,n){const l=Math.atan2(n.y-t.y,n.x-t.x)-Math.atan2(r.y-t.y,r.x-t.x);let s=Math.abs(l*180/Math.PI);return s>180&&(s=360-s),s}function R(r,t){return{x:(r.x+t.x)/2,y:(r.y+t.y)/2,z:(r.z+t.z)/2,visibility:Math.min(r.visibility,t.visibility)}}function k(r){return r.visibility>=.4}function ee(r){const t=r[h.LEFT_HIP],n=r[h.LEFT_KNEE],l=r[h.LEFT_ANKLE],s=r[h.RIGHT_HIP],x=r[h.RIGHT_KNEE],o=r[h.RIGHT_ANKLE],p=r[h.LEFT_SHOULDER],i=r[h.RIGHT_SHOULDER];if(!k(t)||!k(n)||!k(l)||!k(s)||!k(x)||!k(o))return{posture:"Minor Issues",feedback:["Step back so full body is visible"],risk:"Low",angle1:null,angle2:null};const g=(L(t,n,l)+L(s,x,o))/2;let y=180;k(p)&&k(i)&&(y=L(R(p,i),R(t,s),n));const j=Math.abs(l.x-o.x)>0&&Math.abs(n.x-x.x)<Math.abs(l.x-o.x)*.6,b=[];let m="Correct",f="Low";return j&&(b.push("Push knees outward - align with toes"),m="Incorrect",f="High"),y<150&&(b.push("Keep chest up - avoid rounding back"),m="Incorrect",f="High"),g>120&&(m==="Correct"&&(m="Minor Issues"),b.push("Go deeper - bend knees more"),f==="Low"&&(f="Moderate")),{posture:m,feedback:b,risk:f,angle1:Math.round(g),angle2:Math.round(y)}}function re(r){const t=r[h.LEFT_SHOULDER],n=r[h.RIGHT_SHOULDER],l=r[h.LEFT_ELBOW],s=r[h.RIGHT_ELBOW],x=r[h.LEFT_WRIST],o=r[h.RIGHT_WRIST],p=r[h.LEFT_HIP],i=r[h.RIGHT_HIP],g=r[h.LEFT_KNEE],y=r[h.RIGHT_KNEE];if(!k(t)||!k(l)||!k(x))return{posture:"Minor Issues",feedback:["Ensure upper body is clearly visible"],risk:"Low",angle1:null,angle2:null};const j=(L(t,l,x)+L(n,s,o))/2;let b=180;k(p)&&k(i)&&k(g)&&(b=L(R(t,n),R(p,i),R(g,y)));const m=[];let f="Correct",w="Low";return b<160&&(m.push("Engage core - hips are sagging"),f="Incorrect",w="High"),j>160&&(f==="Correct"&&(f="Minor Issues"),m.push("Lower more - bend elbows fully"),w==="Low"&&(w="Moderate")),{posture:f,feedback:m,risk:w,angle1:Math.round(j),angle2:Math.round(b)}}function te(r){const t=r[h.LEFT_SHOULDER],n=r[h.RIGHT_SHOULDER],l=r[h.LEFT_ELBOW],s=r[h.RIGHT_ELBOW],x=r[h.LEFT_WRIST],o=r[h.RIGHT_WRIST];if(!k(t)||!k(l)||!k(x))return{posture:"Minor Issues",feedback:["Ensure full arm is visible"],risk:"Low",angle1:null,angle2:null};const p=(L(t,l,x)+L(n,s,o))/2,i=Math.abs(t.x-n.x),g=Math.abs(l.x-s.x),y=i>0&&Math.abs(g-i)/i>.15,j=[];let b="Correct",m="Low";return y&&(b==="Correct"&&(b="Minor Issues"),j.push("Keep upper arm still - avoid swinging"),m==="Low"&&(m="Moderate")),p>140&&(b==="Correct"&&(b="Minor Issues"),j.push("Curl fully - squeeze bicep at top")),{posture:b,feedback:j,risk:m,angle1:Math.round(p),angle2:null}}function se(r,t){return r==="squat"?ee(t):r==="pushup"?re(t):te(t)}function ae(r,t,n,l,s){const x=s==="Correct"?"#22c55e":s==="Minor Issues"?"#f59e0b":"#ef4444";r.strokeStyle=x,r.lineWidth=3,r.lineCap="round";for(const[o,p]of Z){const i=t[o],g=t[p];!i||!g||i.visibility<.3||g.visibility<.3||(r.beginPath(),r.moveTo(i.x*n,i.y*l),r.lineTo(g.x*n,g.y*l),r.stroke())}for(const o of t)!o||o.visibility<.3||(r.beginPath(),r.arc(o.x*n,o.y*l,5,0,2*Math.PI),r.fillStyle="#ffffff",r.fill(),r.strokeStyle=x,r.lineWidth=2,r.stroke())}const $={squat:{label:"Squat",emoji:"ðŸ‹ï¸",angle1Label:"Knee",angle2Label:"Back",tip:"Stand sideways to the camera, full body visible."},pushup:{label:"Push-up",emoji:"ðŸ’ª",angle1Label:"Elbow",angle2Label:"Back",tip:"Position camera to your side at floor level."},curl:{label:"Bicep Curl",emoji:"ðŸ¦¾",angle1Label:"Elbow",angle2Label:null,tip:"Face the camera with arms fully visible."}},ne=()=>{const r=c.useRef(null),t=c.useRef(null),[n,l]=c.useState("squat"),[s,x]=c.useState({posture:"Correct",feedback:[],risk:"Low",reps:0,angle1:null,angle2:null}),[o,p]=c.useState(!1),[i,g]=c.useState(!1),[y,j]=c.useState(null),[b,m]=c.useState(!1),f=c.useRef("up"),w=c.useRef(0),C=c.useRef(""),E=c.useRef(null),S=c.useRef(null);c.useEffect(()=>{if(window.Pose&&window.Camera){m(!0);return}const d=[{id:"mp-drawing",src:"https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"},{id:"mp-pose",src:"https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js"},{id:"mp-camera",src:"https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"}];let a=0;for(const N of d){if(document.getElementById(N.id)){a++,a===d.length&&m(!0);continue}const v=document.createElement("script");v.id=N.id,v.src=N.src,v.crossOrigin="anonymous",v.onload=()=>{a++,a===d.length&&m(!0)},v.onerror=()=>j("Failed to load MediaPipe. Check your internet connection."),document.head.appendChild(v)}},[]),c.useEffect(()=>{w.current=0,f.current="up",C.current="",x(d=>({...d,reps:0,feedback:[],posture:"Correct",risk:"Low"}))},[n]);const T=c.useCallback(d=>{const a=t.current,N=r.current;if(!a||!N)return;const v=a.getContext("2d");if(!v||(a.width=N.videoWidth||640,a.height=N.videoHeight||480,v.clearRect(0,0,a.width,a.height),!d.poseLandmarks))return;const z=d.poseLandmarks,P=se(n,z),W=P.angle1;let G=w.current;if(W!==null){const K=n==="squat"?W<110:n==="pushup"?W<100:W<60;K&&f.current==="up"?f.current="down":!K&&f.current==="down"&&(f.current="up",G++,w.current=G)}const A=P.feedback.join("|");A!==C.current&&(C.current=A),x({...P,reps:G}),ae(v,z,a.width,a.height,P.posture)},[n]),M=c.useCallback(async()=>{if(!b){j("MediaPipe still loading, please wait...");return}const d=window;if(!d.Pose||!d.Camera){j("MediaPipe not ready. Refresh and try again.");return}g(!0),j(null);try{const a=new d.Pose({locateFile:v=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose/${v}`});a.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1,minDetectionConfidence:.5,minTrackingConfidence:.5}),a.onResults(T),E.current=a;const N=new d.Camera(r.current,{onFrame:async()=>{await a.send({image:r.current})},width:640,height:480});N.start(),S.current=N,p(!0)}catch(a){j("Camera error: "+((a==null?void 0:a.message)||"Unknown error"))}finally{g(!1)}},[b,T]),I=c.useCallback(()=>{S.current&&(S.current.stop(),S.current=null),E.current&&(E.current.close(),E.current=null);const d=t.current;if(d){const a=d.getContext("2d");a==null||a.clearRect(0,0,d.width,d.height)}p(!1),w.current=0,f.current="up",x({posture:"Correct",feedback:[],risk:"Low",reps:0,angle1:null,angle2:null})},[]);c.useEffect(()=>()=>{I()},[I]);const _={Correct:"text-green-400 bg-green-900/30 border-green-500","Minor Issues":"text-yellow-400 bg-yellow-900/30 border-yellow-500",Incorrect:"text-red-400 bg-red-900/30 border-red-500"},H={Low:"text-green-300 bg-green-900/20",Moderate:"text-yellow-300 bg-yellow-900/20",High:"text-red-300 bg-red-900/20"},F={Correct:"âœ…","Minor Issues":"âš ï¸",Incorrect:"âŒ"},u=$[n];return e.jsxs("div",{className:"mt-6 animate-fade-in",children:[e.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"AI Form Monitor"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Real-time posture analysis via webcam"})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:Object.entries($).map(([d,a])=>e.jsxs("button",{onClick:()=>l(d),disabled:o,className:`px-3 py-1.5 rounded-lg text-sm font-semibold transition-all border ${n===d?"bg-green-600 text-white border-green-600 shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-600"} disabled:opacity-60 disabled:cursor-not-allowed`,children:[a.emoji," ",a.label]},d))})]}),y&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/40 border border-red-300 dark:border-red-700 rounded-lg text-red-700 dark:text-red-300 text-sm",children:y}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"relative bg-gray-900 rounded-xl overflow-hidden aspect-video shadow-2xl border border-gray-700",children:[e.jsx("video",{ref:r,id:"form-monitor-video",className:"absolute inset-0 w-full h-full object-cover",autoPlay:!0,muted:!0,playsInline:!0}),e.jsx("canvas",{ref:t,id:"form-monitor-canvas",className:"absolute inset-0 w-full h-full object-cover"}),!o&&!i&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-900/80 text-center px-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:u.emoji}),e.jsxs("p",{className:"text-white text-lg font-semibold mb-1",children:[u.label," Form Monitor"]}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:u.tip}),e.jsx("button",{onClick:M,disabled:!b,className:"px-6 py-3 bg-green-600 hover:bg-green-500 disabled:bg-gray-600 text-white font-bold rounded-xl shadow-lg transition-all transform hover:scale-105 text-sm",children:b?"Start Monitoring":"Loading MediaPipe..."})]}),i&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-900/80",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-green-500 border-t-transparent rounded-full animate-spin mb-3"}),e.jsx("p",{className:"text-white text-sm",children:"Initializing camera..."})]}),o&&e.jsxs("div",{className:"absolute top-3 left-3 flex items-center space-x-2 bg-black/60 rounded-full px-3 py-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),e.jsx("span",{className:"text-white text-xs font-bold",children:"LIVE"})]}),o&&s.angle1!==null&&e.jsxs("div",{className:"absolute bottom-3 left-3 flex gap-2",children:[e.jsxs("div",{className:"bg-black/60 rounded-lg px-2 py-1 text-xs text-white",children:[e.jsxs("span",{className:"text-gray-400",children:[u.angle1Label,": "]}),e.jsxs("span",{className:"font-bold text-green-400",children:[s.angle1,"deg"]})]}),u.angle2Label&&s.angle2!==null&&e.jsxs("div",{className:"bg-black/60 rounded-lg px-2 py-1 text-xs text-white",children:[e.jsxs("span",{className:"text-gray-400",children:[u.angle2Label,": "]}),e.jsxs("span",{className:"font-bold text-blue-400",children:[s.angle2,"deg"]})]})]})]}),e.jsx("div",{className:"mt-3 flex gap-3 justify-center",children:o?e.jsx("button",{onClick:I,className:"px-5 py-2 bg-red-600 hover:bg-red-500 text-white font-semibold rounded-lg transition-all",children:"Stop"}):e.jsx("button",{onClick:M,disabled:i||!b,className:"px-5 py-2 bg-green-600 hover:bg-green-500 text-white font-semibold rounded-lg transition-all disabled:opacity-50",children:i?"Starting...":"Start"})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:`rounded-xl border-2 p-4 transition-all ${o?_[s.posture]:"border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800/50 text-gray-500"}`,children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest mb-1 opacity-70",children:"Posture"}),e.jsx("p",{className:"text-2xl font-black",children:o?`${F[s.posture]} ${s.posture}`:"-- Idle"})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4 flex-1",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest text-gray-400 mb-2",children:"Feedback"}),!o||s.feedback.length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:o?"Form looks good! Keep it up.":"Start monitoring to see feedback."}):e.jsx("ul",{className:"space-y-2",children:s.feedback.map((d,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-500 mt-0.5",children:"*"}),e.jsx("span",{className:"text-sm text-gray-800 dark:text-gray-200 font-medium",children:d})]},a))})]}),e.jsxs("div",{className:`rounded-xl p-4 ${o?H[s.risk]:"bg-gray-100 dark:bg-gray-800"}`,children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest text-gray-400 mb-1",children:"Risk Level"}),e.jsx("p",{className:"text-lg font-bold",children:o?s.risk==="Low"?"Low":s.risk==="Moderate"?"Moderate":"High":"-- N/A"})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest text-gray-400",children:"Reps"}),e.jsx("span",{className:"text-4xl font-black text-green-500 tabular-nums",children:s.reps})]}),e.jsxs("div",{className:"rounded-xl bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-900/40 p-3",children:[e.jsx("p",{className:"text-xs font-semibold text-blue-600 dark:text-blue-400 mb-1",children:"Tip"}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:u.tip})]})]})]})]})},le=()=>{const[r,t]=c.useState(""),[n,l]=c.useState(null),[s,x]=c.useState(!1),[o,p]=c.useState(null),i=async()=>{if(!r.trim()){p("Please enter an exercise name.");return}x(!0),p(null),l(null);try{const g=await X(r);l(g)}catch(g){p(U(g))}finally{x(!1)}};return e.jsxs("div",{className:"mt-6 bg-gray-50 dark:bg-gray-800/50 p-4 md:p-6 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("textarea",{value:r,onChange:g=>t(g.target.value),placeholder:"e.g., Kettlebell Swing",rows:1,className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-500"}),e.jsx("button",{onClick:i,disabled:s,className:"w-full py-2 px-4 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 disabled:bg-gray-400 dark:disabled:bg-gray-600",children:s?"Generating Guide...":"Generate Exercise Guide"})]}),e.jsxs("div",{className:"mt-6 min-h-[300px] bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center p-4",children:[s&&e.jsx(Q,{message:"Creating your exercise guide..."}),o&&e.jsx("p",{className:"text-red-500 text-center",children:o}),n&&e.jsxs("div",{className:"w-full text-left p-2 md:p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 border-b border-gray-200 dark:border-gray-600 pb-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 capitalize",children:n.name}),e.jsxs("a",{href:`https://www.youtube.com/results?search_query=${encodeURIComponent(n.youtubeQuery)}`,target:"_blank",rel:"noopener noreferrer",className:"mt-2 sm:mt-0 inline-flex items-center px-4 py-2 bg-red-600 text-white text-sm font-semibold rounded-lg hover:bg-red-700 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"})}),"Watch Tutorial"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-lg text-gray-700 dark:text-gray-200 mb-3 flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 flex items-center justify-center mr-2 text-sm",children:"1"}),"Steps"]}),e.jsx("ol",{className:"space-y-3",children:n.steps.map((g,y)=>e.jsxs("li",{className:"flex items-start text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"mr-2 mt-1.5 w-1.5 h-1.5 bg-green-500 rounded-full flex-shrink-0"}),e.jsx("span",{children:g})]},y))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-lg text-gray-700 dark:text-gray-200 mb-3 flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 flex items-center justify-center mr-2 text-sm",children:"!"}),"Tips"]}),e.jsx("ul",{className:"space-y-3",children:n.tips.map((g,y)=>e.jsxs("li",{className:"flex items-start text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"mr-2 mt-1.5 w-1.5 h-1.5 bg-blue-500 rounded-full flex-shrink-0"}),e.jsx("span",{children:g})]},y))})]})]})]}),!s&&!o&&!n&&e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Your generated guide will appear here."})]})]})},oe=({exercise:r,onLog:t,healthIssues:n})=>{const[l,s]=c.useState(r.sets||1),[x,o]=c.useState(!1),p=()=>{const i=r.caloriesBurnedPerSet*l;t(i,r.name),o(!0)};return e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden flex flex-col border border-gray-100 dark:border-gray-700 hover:shadow-lg transition-shadow duration-200",children:e.jsxs("div",{className:"p-5 flex flex-col flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-bold text-xl text-gray-900 dark:text-gray-100 leading-tight",children:r.name}),e.jsx("a",{href:`https://www.youtube.com/results?search_query=${encodeURIComponent(r.youtubeQuery)}`,target:"_blank",rel:"noopener noreferrer",className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors flex-shrink-0 ml-2",title:"Watch on YouTube",children:e.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"})})})]}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4 text-sm text-gray-600 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white mr-1",children:r.sets})," sets"]}),e.jsx("div",{className:"w-px h-4 bg-gray-300 dark:bg-gray-600"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white mr-1",children:r.reps})," reps"]}),e.jsx("div",{className:"w-px h-4 bg-gray-300 dark:bg-gray-600"}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"font-bold text-gray-900 dark:text-white mr-1",children:["~",(r.caloriesBurnedPerSet*(r.sets||1)).toFixed(0)]})," kcal"]})]}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex-grow mb-4 space-y-3",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700 dark:text-gray-200 mb-1",children:"Instructions:"}),e.jsx("ol",{className:"list-decimal list-inside space-y-1 pl-1 marker:text-gray-400",children:r.steps.slice(0,3).map((i,g)=>e.jsx("li",{className:"line-clamp-2",children:i},g))}),r.steps.length>3&&e.jsx("p",{className:"text-xs text-gray-400 mt-1 pl-4 italic",children:"...and more"})]})}),r.modifications&&r.modifications.length>0&&e.jsxs("details",{className:"mb-3 text-xs",children:[e.jsx("summary",{className:"cursor-pointer font-semibold text-gray-600 dark:text-gray-300 hover:text-green-600 transition-colors",children:"Modifications"}),e.jsx("ul",{className:"list-disc list-inside pl-4 mt-1 text-gray-500 dark:text-gray-400",children:r.modifications.map((i,g)=>e.jsx("li",{children:i},g))})]}),e.jsxs("details",{className:"mb-4 text-xs",children:[e.jsx("summary",{className:"cursor-pointer font-semibold text-gray-600 dark:text-gray-300 hover:text-green-600 transition-colors",children:"Coach's Tip"}),e.jsxs("p",{className:"mt-1 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded border border-yellow-100 dark:border-yellow-900/30 text-gray-600 dark:text-gray-400 italic",children:['"',r.videoScript,'"']})]}),e.jsxs("div",{className:"mt-auto pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mb-2",children:"Log your completed sets:"}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-3",children:[e.jsx("button",{onClick:()=>s(i=>Math.max(1,i-1)),className:"px-2 py-1 bg-gray-100 dark:bg-gray-600 rounded hover:bg-gray-200 dark:hover:bg-gray-500",disabled:x,children:"-"}),e.jsx("input",{type:"number",value:l,onChange:i=>s(parseInt(i.target.value)||1),className:"w-12 text-center bg-transparent border-b border-gray-300 dark:border-gray-600 dark:text-white focus:outline-none focus:border-green-500",disabled:x}),e.jsx("button",{onClick:()=>s(i=>i+1),className:"px-2 py-1 bg-gray-100 dark:bg-gray-600 rounded hover:bg-gray-200 dark:hover:bg-gray-500",disabled:x,children:"+"})]}),e.jsx("button",{onClick:p,className:"w-full py-2 px-4 text-white font-semibold rounded-lg shadow-sm transition-colors disabled:bg-gray-400 dark:disabled:bg-gray-600 bg-green-600 hover:bg-green-700",disabled:x,children:x?"Logged Ã¢Å“â€":`Log Activity (~${(r.caloriesBurnedPerSet*l).toFixed(0)} kcal)`})]})]})})},ie=()=>{var _,H,F;const{user:r,addCaloriesOut:t,navigateTo:n}=q(),[l,s]=c.useState([]),[x,o]=c.useState(""),[p,i]=c.useState(D[0]),[g,y]=c.useState(!1),[j,b]=c.useState(""),[m,f]=c.useState(null),[w,C]=c.useState([]),E=m?(((_=m.warmUp)==null?void 0:_.length)||0)+(((H=m.mainWorkout)==null?void 0:H.length)||0)+(((F=m.coolDown)==null?void 0:F.length)||0):0,S=E>0?w.length/E*100:0,T=u=>{s(d=>d.includes(u)?d.filter(a=>a!==u):[...d,u])},M=async u=>{if(u.preventDefault(),!r){b("User profile not found.");return}y(!0),b(""),f(null),C([]);const d={healthIssues:l,trimester:l.includes("Pregnant")?x:void 0,preference:p};try{const a=await Y(r,d);f(a)}catch(a){b(`Failed to generate exercise routine. ${U(a)} Please try again.`),console.error(a)}finally{y(!1)}},I=(u,d)=>{t(u),C(a=>[...a,d]),alert(`${u.toFixed(0)} calories burned from ${d} have been logged!`)};return g?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-3 mb-6 text-green-600 dark:text-green-400",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-current"}),e.jsx("p",{className:"text-lg font-semibold",children:"Curating your expert workout plan..."})]}),e.jsx(J,{})]}):m?e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md sticky top-[70px] z-10 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-700 dark:text-green-400 mb-2",children:"Your Custom Workout"}),e.jsxs("div",{className:"flex justify-between text-sm font-medium text-gray-600 dark:text-gray-300 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[w.length," / ",E," exercises"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:`${S}%`}})}),S===100&&e.jsx("p",{className:"text-center text-green-600 dark:text-green-400 font-semibold mt-2",children:"Workout Complete! Great job!"})]}),e.jsx(O,{title:"Warm-up",exercises:m.warmUp,onLog:I,healthIssues:l}),e.jsx(O,{title:"Main Workout",exercises:m.mainWorkout,onLog:I,healthIssues:l}),e.jsx(O,{title:"Cool-down",exercises:m.coolDown,onLog:I,healthIssues:l}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4 mt-8",children:[e.jsx("button",{onClick:()=>f(null),className:"py-2 px-6 bg-gray-500 text-white font-semibold rounded-lg shadow-md hover:bg-gray-600",children:"Generate New Workout"}),e.jsx("button",{onClick:()=>n("TODAYS_GOAL"),className:"py-2 px-6 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700",children:"View Today's Goal"})]})]}):e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[j&&e.jsx("p",{className:"text-red-500 bg-red-100 dark:bg-red-900/50 dark:text-red-300 p-3 rounded-lg",children:j}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Any Health Constraints?"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:V.map(u=>e.jsxs("label",{className:`flex items-center space-x-2 p-3 rounded-lg cursor-pointer border-2 ${l.includes(u)?"bg-green-100 border-green-400 dark:bg-green-900/50 dark:border-green-600":"bg-gray-50 border-gray-200 dark:bg-gray-700 dark:border-gray-600"}`,children:[e.jsx("input",{type:"checkbox",checked:l.includes(u),onChange:()=>T(u),className:"form-checkbox h-5 w-5 text-green-600 rounded"}),e.jsx("span",{className:"dark:text-gray-300",children:u})]},u))})]}),l.includes("Pregnant")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Which trimester?"}),e.jsxs("select",{value:x,onChange:u=>o(u.target.value),className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"1st",children:"1st Trimester"}),e.jsx("option",{value:"2nd",children:"2nd Trimester"}),e.jsx("option",{value:"3rd",children:"3rd Trimester"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Exercise Preference"}),e.jsx("select",{value:p,onChange:u=>i(u.target.value),className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-gray-900 dark:text-gray-100",children:D.map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsx("button",{type:"submit",className:"w-full py-3 px-4 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700",children:"Generate Workout"})]})},O=({title:r,exercises:t,onLog:n,healthIssues:l})=>!t||t.length===0?null:e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200 mb-4 border-b-2 border-green-500 pb-2",children:r}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((s,x)=>e.jsx(oe,{exercise:s,onLog:n,healthIssues:l},x))})]}),xe=()=>{const[r,t]=c.useState("plan");return e.jsxs("div",{className:"max-w-6xl mx-auto bg-white dark:bg-gray-800 p-4 md:p-8 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 animate-fade-in-up",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-6",children:"Exercise Corner"}),e.jsxs("div",{className:"flex flex-col sm:flex-row border-b border-gray-200 dark:border-gray-700 mb-6",children:[e.jsxs("button",{onClick:()=>t("plan"),className:`flex items-center space-x-2 px-4 py-3 text-lg font-semibold border-b-2 transition-colors ${r==="plan"?"border-green-500 text-green-600 dark:text-green-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[B.dumbbell,e.jsx("span",{children:"Get a Full Workout"})]}),e.jsxs("button",{onClick:()=>t("visualize"),className:`flex items-center space-x-2 px-4 py-3 text-lg font-semibold border-b-2 transition-colors ${r==="visualize"?"border-green-500 text-green-600 dark:text-green-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polygon",{points:"23 7 16 12 23 17 23 7"}),e.jsx("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]}),e.jsx("span",{children:"Find a Tutorial"})]}),e.jsxs("button",{onClick:()=>t("form"),className:`flex items-center space-x-2 px-4 py-3 text-lg font-semibold border-b-2 transition-colors ${r==="form"?"border-green-500 text-green-600 dark:text-green-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("span",{children:"Form Monitor"})]})]}),r==="plan"&&e.jsx(ie,{}),r==="visualize"&&e.jsx(le,{}),r==="form"&&e.jsx(ne,{})]})};export{xe as default};
