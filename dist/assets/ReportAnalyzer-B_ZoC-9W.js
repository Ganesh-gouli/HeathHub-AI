import{u as z,r as l,D as B,j as e,I as g,L as H,C as K,f as X,h as Y,c as _}from"./index-CXTOnbpn.js";import{L as J}from"./LoadingSpinner-BDg57fWP.js";import{R as q}from"./Skeletons-Bt8z-9NO.js";const p=({textToSpeak:N,title:b,language:j})=>{const[y,f]=l.useState(!1),d=l.useRef(null),[v,o]=l.useState([]);l.useEffect(()=>{const c=()=>{o(window.speechSynthesis.getVoices())};window.speechSynthesis.addEventListener("voiceschanged",c),c();const x=new SpeechSynthesisUtterance;return d.current=x,x.onstart=()=>f(!0),x.onend=()=>f(!1),x.onerror=i=>{i.error!=="interrupted"&&console.error("Speech synthesis error:",i.error),f(!1)},()=>{window.speechSynthesis.removeEventListener("voiceschanged",c),window.speechSynthesis.cancel()}},[]);const C=()=>{if(d.current)if(y)window.speechSynthesis.cancel();else{window.speechSynthesis.cancel();const c=`${b}. ${N}`;d.current.text=c;const i={English:"en-US",Hindi:"hi-IN",Kannada:"kn-IN",Tamil:"ta-IN",Telugu:"te-IN",Bengali:"bn-IN",Marathi:"mr-IN",Gujarati:"gu-IN"}[j]||"en-US";d.current.lang=i;const w=v.find(k=>k.lang===i)||v.find(k=>k.lang.startsWith(i.split("-")[0]));w?d.current.voice=w:d.current.voice=null,window.speechSynthesis.speak(d.current)}};return e.jsx("button",{onClick:C,className:"p-2 rounded-full text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors","aria-label":y?`Stop reading ${b}`:`Read ${b} aloud`,children:y?g.speakerOff:g.speaker})},re=()=>{const{user:N,reportAnalysis:b,setReportAnalysis:j,navigateTo:y,addFoodItems:f,dailyLog:d,removeFoodItem:v}=z(),[o,C]=l.useState(null),[c,x]=l.useState(null),[i,w]=l.useState(B[0]),[k,A]=l.useState(!1),[E,I]=l.useState(""),[S,T]=l.useState("English"),G=r=>{var m;const t=(m=r.target.files)==null?void 0:m[0];t&&(C(t),t.type.startsWith("image/")?x(URL.createObjectURL(t)):x(null))},U=async r=>{if(r.preventDefault(),!N||!o){I("Please upload a report and ensure you are logged in.");return}A(!0),I(""),j(null);try{const t=await X(o),m=await Y(N,i,t,o.type,S);j(m)}catch(t){I(`Failed to analyze report. ${_(t)} Please try again with a clear document.`),console.error(t)}finally{A(!1)}},V=({analysis:r,language:t})=>{var D,M,F,$;const{user:m}=z(),W=s=>{const a=d.loggedFoods.find(n=>n.name===s.name&&n.calories===s.calories&&n.source==="plan");a?v(a):f([{name:s.name,calories:s.calories}],"plan")},R=({title:s,options:a})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-md transition-shadow duration-200",children:[e.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white mb-4 border-b border-gray-100 dark:border-gray-700 pb-2",children:s}),e.jsx("ul",{className:"space-y-3",children:(a||[]).map((n,L)=>{const h=d.loggedFoods.some(P=>P.name===n.name&&P.calories===n.calories&&P.source==="plan");return e.jsxs("li",{className:`flex flex-col sm:flex-row justify-between items-start sm:items-center p-3 rounded-xl transition-all duration-200 border ${h?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-700/30 border-transparent hover:border-gray-200 dark:hover:border-gray-600"}`,children:[e.jsxs("div",{className:"flex-grow pr-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`font-semibold ${h?"text-green-800 dark:text-green-300":"text-gray-800 dark:text-gray-200"}`,children:n.name}),h&&e.jsx("span",{className:"ml-2 text-green-600 dark:text-green-400 text-xs",children:g.checkCircle})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 leading-snug",children:n.description}),e.jsxs("span",{className:"inline-block mt-1 text-xs font-medium text-gray-400 dark:text-gray-500",children:[n.calories," kcal"]})]}),e.jsx("button",{onClick:()=>W(n),className:`mt-2 sm:mt-0 flex-shrink-0 text-xs font-semibold px-4 py-2 rounded-lg transition-all duration-200 shadow-sm ${h?"bg-red-50 text-red-600 hover:bg-red-100 dark:bg-red-900/20 dark:text-red-300 dark:hover:bg-red-900/40":"bg-green-600 text-white hover:bg-green-700 dark:bg-green-600 dark:hover:bg-green-500"}`,children:h?"Remove":"Add"})]},L)})})]}),u=({title:s,items:a})=>{const n=a&&a.length>0?a.join(". "):"No information provided.";return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"font-bold text-green-700 dark:text-green-400",children:s}),e.jsx(p,{title:s,textToSpeak:n,language:t})]}),a&&a.length>0?e.jsx("ul",{className:"space-y-2 text-gray-600 dark:text-gray-300 text-sm",children:a.map((L,h)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-green-500 mt-1",children:"â€¢"}),e.jsx("span",{children:L})]},h))}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:"No information provided."})]})},O=`Patient Name: ${r.patientInfo.name}. Age: ${r.patientInfo.age}. Gender: ${r.patientInfo.gender}. Report Date: ${r.patientInfo.reportDate}.`;return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fade-in px-2 sm:px-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end border-b border-gray-200 dark:border-gray-700 pb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Report Analysis"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"AI-generated insights from your medical document."})]}),e.jsxs("button",{onClick:()=>j(null),className:"mt-4 md:mt-0 text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-700 hover:underline flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Analyze Another Report"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-50 dark:bg-blue-900/20 rounded-full blur-3xl -mr-16 -mt-16"}),e.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 flex items-center justify-center mr-3",children:g.user}),"Patient Details"]}),e.jsx(p,{title:"Patient Information",textToSpeak:O,language:t})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 text-sm relative z-10",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/30 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs uppercase tracking-wider mb-1",children:"Name"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.patientInfo.name})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/30 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs uppercase tracking-wider mb-1",children:"Age"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.patientInfo.age})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/30 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs uppercase tracking-wider mb-1",children:"Gender"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.patientInfo.gender})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/30 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs uppercase tracking-wider mb-1",children:"Date"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.patientInfo.reportDate})]})]})]}),r.actionPlan&&r.actionPlan.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-white dark:from-green-900/20 dark:to-gray-800 border border-green-200 dark:border-green-800/50 p-6 rounded-2xl shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-green-900 dark:text-green-300",children:"Priority Action Plan"}),e.jsx(p,{title:"Your Action Plan",textToSpeak:r.actionPlan.join(". "),language:t})]}),e.jsx("ul",{className:"space-y-3",children:r.actionPlan.map((s,a)=>e.jsxs("li",{className:"flex items-start bg-white/60 dark:bg-gray-900/40 p-3 rounded-xl",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mt-0.5 mr-3 flex-shrink-0 bg-green-100 dark:bg-green-900/50 rounded-full p-0.5",children:g.checkCircle}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200 font-medium",children:s})]},a))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Summary"}),e.jsx(p,{title:"Report Summary",textToSpeak:r.reportSummary,language:t})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed text-sm",children:r.reportSummary})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Explanation"}),e.jsx(p,{title:"Problem Explanation",textToSpeak:r.problemExplanation,language:t})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed text-sm",children:r.problemExplanation})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6 flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 flex items-center justify-center mr-3 text-sm",children:g.diet}),"Dietary Recommendations"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(R,{title:"Breakfast",options:((D=r.mealPlan)==null?void 0:D.breakfast)||[]}),e.jsx(R,{title:"Lunch",options:((M=r.mealPlan)==null?void 0:M.lunch)||[]}),e.jsx(R,{title:"Snacks",options:((F=r.mealPlan)==null?void 0:F.snacks)||[]}),e.jsx(R,{title:"Dinner",options:(($=r.mealPlan)==null?void 0:$.dinner)||[]})]}),r.reasoning&&e.jsxs("div",{className:"mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800/50 p-6 rounded-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-lg font-bold text-blue-900 dark:text-blue-300",children:"Why this plan?"}),e.jsx(p,{title:"Diet Plan Reasoning",textToSpeak:r.reasoning,language:t})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-sm",children:r.reasoning})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(u,{title:"Foods to Include",items:r.foodsToInclude}),e.jsx(u,{title:"Foods to Avoid",items:r.foodsToAvoid}),e.jsx(u,{title:"Treatment Ideas",items:r.treatmentRecommendations}),e.jsx(u,{title:"Key Recommendations",items:r.keyRecommendations}),e.jsx(u,{title:"Precautions",items:r.precautions}),e.jsx(u,{title:"Lifestyle Changes",items:r.lifestyleModifications})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1",children:"Recommended Exercises"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Tailored movement based on your report."})]}),e.jsx("button",{onClick:()=>y("EXERCISE_CORNER"),className:"px-6 py-3 bg-gray-900 dark:bg-gray-700 text-white font-bold rounded-xl shadow-lg hover:bg-gray-800 dark:hover:bg-gray-600 transition-colors",children:"View Exercise Guide"})]}),r.exerciseRoutine&&r.exerciseRoutine.length>0?e.jsx("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:r.exerciseRoutine.map((s,a)=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/30 p-4 rounded-xl",children:e.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:s.name})},a))}):e.jsx("p",{className:"mt-4 text-gray-500 dark:text-gray-400 text-sm",children:"No specific exercises recommended based on this report."})]}),e.jsx("div",{className:"mt-8 bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:m&&e.jsx("div",{className:"h-[600px]",children:e.jsx(K,{isOpen:!0,onClose:()=>{},user:m,contextData:{reportAnalysis:r},language:S,setLanguage:T,mode:"report",isEmbedded:!0})})})]})};return k?e.jsxs("div",{className:"max-w-5xl mx-auto p-4 md:p-8",children:[e.jsx(J,{message:"Analyzing your medical report..."}),e.jsx("div",{className:"opacity-25 pointer-events-none filter blur-sm transition-all duration-700",children:e.jsx(q,{})})]}):b?e.jsx(V,{analysis:b,language:S}):e.jsxs("div",{className:"max-w-4xl mx-auto bg-white dark:bg-gray-800 p-6 md:p-10 rounded-3xl shadow-xl border border-gray-100 dark:border-gray-700 animate-fade-in-up",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 mb-4",children:g.report}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 dark:text-white tracking-tight",children:"Medical Report Analyzer"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2 text-lg",children:"Upload your report for an instant AI-powered summary and advice."})]}),e.jsxs("form",{onSubmit:U,className:"space-y-8",children:[E&&e.jsxs("div",{className:"flex items-start p-4 bg-red-50 dark:bg-red-900/30 rounded-xl border border-red-100 dark:border-red-800",children:[e.jsx("div",{className:"flex-shrink-0 text-red-500 dark:text-red-400",children:g.warning}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:E})})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2 uppercase tracking-wider",children:"Upload Document"}),e.jsxs("label",{htmlFor:"file-upload",className:`relative flex flex-col items-center justify-center w-full h-64 border-2 border-dashed rounded-2xl cursor-pointer transition-all duration-300 ${o?"border-green-500 bg-green-50 dark:bg-green-900/10":"border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/30 hover:bg-gray-100 dark:hover:bg-gray-700 hover:border-green-400"}`,children:[e.jsx("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:c?e.jsx("img",{src:c,alt:"Report preview",className:"h-48 w-auto object-contain rounded-lg shadow-sm"}):o?e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-white dark:bg-gray-800 rounded-full flex items-center justify-center shadow-sm mb-3",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate max-w-xs",children:o.name}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:"Click to change"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-white dark:bg-gray-800 rounded-full flex items-center justify-center shadow-sm mb-4 group-hover:scale-110 transition-transform duration-300",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400 dark:text-gray-500 group-hover:text-green-500 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400",children:"Click to upload"})," or drag and drop"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"SVG, PNG, JPG or PDF (MAX. 10MB)"})]})}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:G,accept:"image/*,application/pdf"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Language"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:S,onChange:r=>T(r.target.value),className:"block w-full px-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all appearance-none cursor-pointer",children:H.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-500",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Dietary Preference"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:i,onChange:r=>w(r.target.value),className:"block w-full px-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all appearance-none cursor-pointer",children:B.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-500",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]})]}),e.jsx("button",{type:"submit",disabled:!o,className:"w-full py-4 px-6 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold text-lg rounded-2xl shadow-lg shadow-blue-500/30 hover:shadow-xl hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none disabled:transform-none transition-all duration-200",children:"Analyze Report"})]})]})};export{re as default};
